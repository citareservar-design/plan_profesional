{% extends "admin/layout.html" %}
{% block content %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<div id="qr-data-container" 
     data-slug="{{ empresa.emp_id if empresa else 'negocio' }}" 
     data-nombre="{{ empresa.emp_razon_social if empresa and empresa.emp_razon_social else 'Mi Empresa' }}"
     style="display:none;">
</div>

<div class="min-h-[80vh] flex items-center justify-center p-4 antialiased animate-fade-in">
    <div class="max-w-md w-full">
        <div class="bg-slate-800/40 backdrop-blur-2xl rounded-[3rem] border border-white/10 shadow-2xl overflow-hidden relative">
            
            <div class="absolute -top-24 -right-24 w-48 h-48 bg-sky-500/20 blur-[80px] rounded-full"></div>
            <div class="absolute -bottom-24 -left-24 w-48 h-48 bg-purple-500/10 blur-[80px] rounded-full"></div>

            <div class="bg-gradient-to-br from-sky-600/20 to-indigo-600/20 p-8 text-center border-b border-white/5">
                <div class="w-20 h-20 bg-gradient-to-tr from-sky-500 to-indigo-500 rounded-3xl flex items-center justify-center mx-auto mb-4 shadow-2xl rotate-3 hover:rotate-0 transition-transform duration-500">
                    <i class="fa-solid fa-qrcode text-4xl text-white"></i>
                </div>
                <h3 class="text-2xl font-black text-white tracking-tighter uppercase">Mi Acceso QR</h3>
                <p class="text-slate-400 text-sm font-medium mt-1">Tus clientes agendan en segundos</p>
            </div>

            <div class="p-10 flex flex-col items-center justify-center bg-white/5 relative">
                <div class="bg-white p-6 rounded-[2.5rem] shadow-[0_0_50px_rgba(0,0,0,0.3)] transition-transform hover:scale-[1.02] duration-500">
                    <div id="qrcode" class="overflow-hidden"></div>
                </div>
                
                <div class="mt-8 px-4 py-2 bg-slate-900/50 rounded-full border border-white/5 flex items-center gap-3">
                    <span class="text-[10px] font-mono text-sky-400 truncate max-w-[200px]" id="url-text">Cargando enlace...</span>
                    <button onclick="copyLink()" class="text-slate-400 hover:text-white transition-colors">
                        <i class="fa-solid fa-copy text-xs"></i>
                    </button>
                </div>
            </div>

            <div class="p-8 grid grid-cols-2 gap-4">
                <button onclick="downloadQR()" class="flex flex-col items-center justify-center gap-2 p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-3xl transition-all group">
                    <i class="fa-solid fa-cloud-arrow-down text-xl text-sky-400 group-hover:scale-110 transition-transform"></i>
                    <span class="text-[10px] font-bold text-slate-300 uppercase tracking-widest">Descargar</span>
                </button>

                <button onclick="shareLink()" class="flex flex-col items-center justify-center gap-2 p-4 bg-sky-500 hover:bg-sky-400 rounded-3xl transition-all shadow-lg shadow-sky-500/20 group">
                    <i class="fa-solid fa-share-nodes text-xl text-white group-hover:rotate-12 transition-transform"></i>
                    <span class="text-[10px] font-bold text-white uppercase tracking-widest">Compartir</span>
                </button>
            </div>
        </div>

        <p class="mt-8 text-center text-slate-500 text-xs font-medium px-8 leading-relaxed">
            <i class="fa-solid fa-circle-info mr-1 text-sky-500/50"></i>
            Muestra este c√≥digo a tus clientes para que puedan reservar directamente.
        </p>
    </div>
</div>

<script src="{{ url_for('static', filename='js/miqr.js') }}"></script>
{% endblock %}