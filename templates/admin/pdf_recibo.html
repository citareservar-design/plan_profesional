<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style>
        @page { 
            size: 80mm 150mm; 
            margin: 0; 
        }
        body { 
            font-family: 'Courier', monospace; 
            color: #000; 
            width: 260px; 
            margin: 0 auto;
            padding: 5px;
            font-size: 11px;
            line-height: 1.1; /* Datos más juntos */
        }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .bold { font-weight: bold; }
        
        .divider { 
            border-top: 1px dashed #000; 
            margin: 5px 0; 
        }
        
        .header { margin-bottom: 8px; }
        .company-name { font-size: 14px; font-weight: bold; }
        
        /* Tablas compactas */
        table { width: 100%; border-collapse: collapse; }
        .info-table td { padding: 1px 0; }
        
        .items-table td { padding: 2px 0; }

        .total-section { 
            margin-top: 5px; 
            padding-top: 5px;
            border-top: 1px double #000; /* Línea doble para separar el pago */
        }
        .total-value { font-size: 16px; font-weight: bold; }

        .footer { margin-top: 15px; font-size: 9px; }
    </style>
</head>
<body>
    <div class="header text-center">
        <div class="company-name">{{ empresa.emp_razon_social }}</div>
        <div style="font-size: 9px;">{{ empresa.emp_direccion }}</div>
    </div>

    <div class="divider"></div>

    <table class="info-table">
        <tr>
            <td class="bold">FECHA:</td>
            <td class="text-right">{{ r.res_fecha.strftime('%d/%m/%Y') }}</td>
        </tr>
        <tr>
            <td class="bold">HORA:</td>
            <td class="text-right">{{ r.res_hora.strftime('%H:%M') }}</td>
        </tr>
        <tr>
            <td class="bold">CLIENTE:</td>
            <td class="text-right">{{ c.cli_nombre[:20] }}</td>
        </tr>
        <tr>
            <td class="bold">N-RESERVA:</td>
            <td class="text-right">#{{ r.res_id }}</td>
        </tr>
        <tr>
            <td colspan="2" style="padding-top: 5px;">
                <span class="bold">SERV:</span> 
                {{ r.servicio.ser_nombre if r.servicio else r.res_tipo_servicio }}
            </td>
        </tr>
    </table>

<div class="total-section">
    {% if p_desc > 0 %}
    <table>
        <tr>
            <td class="text-right" style="font-size: 11px;">SUBTOTAL:</td>
            <td class="text-right" style="font-size: 11px;">${{ "{:,.0f}".format(p_original) }}</td>
        </tr>
        <tr>
            <td class="text-right" style="font-size: 9px;">DESC. ({{ p_desc|int }}%):</td>
            <td class="text-right" style="font-size: 9px;">-${{ "{:,.0f}".format(p_original - p_final) }}</td>
        </tr>
    </table>
    {% endif %}

    <table style="margin-top: 5px;">
        <tr>
            <td class="bold" style="font-size: 15px;"" >TOTAL A PAGAR:</td>
            <td class="text-right total-value">${{ "{:,.0f}".format(p_final) }}</td>
        </tr>
    </table>
</div>

    <div class="divider"></div>

    <div class="text-center footer">
        <div class="bold">*** GRACIAS POR SU VISITA ***</div>
        <div style="margin-top: 3px;">Conserve este ticket</div>
        <div class="divider"></div>
<div class="text-center" style="font-size: 8px; color: #555; padding: 5px;">
    ESTE ES UN COMPROBANTE DE PAGO NO FISCAL.<br>
    Si requiere factura electrónica, por favor <br>
    solicítela en caja o al correo de la empresa.<br>
    ID Transacción: {{ r.res_id }}
</div>
        <div style="margin-top: 3px;">Impreso por agendapp</div>
    </div>
</body>
</html>